[gd_scene load_steps=15 format=3 uid="uid://chr8s2mrd57b4"]

[ext_resource type="Script" path="res://scripts/RhythmMinigameManager.gd" id="1_xjbte"]
[ext_resource type="AudioStream" uid="uid://kuujalecn71n" path="res://assets/sounds/rhythmdemo.ogg" id="2_ac7ve"]
[ext_resource type="Script" path="res://scripts/RhythmGameInput.gd" id="2_e3i65"]
[ext_resource type="Texture2D" uid="uid://csffd5yka5yx4" path="res://assets/images/arrow1.png" id="4_l17yx"]
[ext_resource type="Texture2D" uid="uid://cdauy3llcjie" path="res://assets/images/arrow2.png" id="5_52atg"]
[ext_resource type="Texture2D" uid="uid://d2ictgkmsfce1" path="res://assets/images/arrow3.png" id="6_p126d"]
[ext_resource type="Texture2D" uid="uid://cuiinpf3ytpcs" path="res://assets/images/arrow4.png" id="7_c7hc3"]
[ext_resource type="Script" path="res://scripts/Conductor.gd" id="7_u1p3x"]
[ext_resource type="Script" path="res://scripts/FpsLabel.gd" id="9_5aavs"]
[ext_resource type="FontFile" uid="uid://c0apde5o5da0g" path="res://assets/fonts/PublicPixel.ttf" id="9_ii8yx"]

[sub_resource type="Animation" id="Animation_jf2fw"]
resource_name = "player_lose"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("RhythmGameHolder:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Color(1, 1, 1, 1), Color(1, 1, 1, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("RhythmGameHolder:position")
tracks/1/interp = 2
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.7),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(0, 0), Vector2(200, 1200)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("RhythmGameHolder:rotation")
tracks/2/interp = 2
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 0.7),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [0.0, -0.502655]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("UIHolder:position")
tracks/3/interp = 2
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0, 0.7),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(0, 0), Vector2(-80, 600)]
}
tracks/4/type = "value"
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/path = NodePath("UIHolder:rotation")
tracks/4/interp = 2
tracks/4/loop_wrap = true
tracks/4/keys = {
"times": PackedFloat32Array(0, 0.7),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [0.0, -1.85354]
}
tracks/5/type = "value"
tracks/5/imported = false
tracks/5/enabled = true
tracks/5/path = NodePath("UIHolder:modulate")
tracks/5/interp = 1
tracks/5/loop_wrap = true
tracks/5/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Color(1, 1, 1, 1), Color(1, 1, 1, 0)]
}
tracks/6/type = "value"
tracks/6/imported = false
tracks/6/enabled = true
tracks/6/path = NodePath("Music:pitch_scale")
tracks/6/interp = 2
tracks/6/loop_wrap = true
tracks/6/keys = {
"times": PackedFloat32Array(0, 0.7),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [1.0, 0.62]
}
tracks/7/type = "value"
tracks/7/imported = false
tracks/7/enabled = true
tracks/7/path = NodePath("Music:volume_db")
tracks/7/interp = 1
tracks/7/loop_wrap = true
tracks/7/keys = {
"times": PackedFloat32Array(0, 0.7),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [0.0, -80.0]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_acjcy"]
_data = {
"player_lose": SubResource("Animation_jf2fw")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_4fsn0"]
size = Vector2(1165, 20)

[sub_resource type="CircleShape2D" id="CircleShape2D_vs5r6"]
radius = 45.0

[node name="RhythmMinigame" type="CanvasLayer"]
script = ExtResource("1_xjbte")

[node name="RhythmMinigameAnimation" type="AnimationPlayer" parent="."]
movie_quit_on_finish = true
libraries = {
"": SubResource("AnimationLibrary_acjcy")
}

[node name="Music" type="AudioStreamPlayer" parent="."]
stream = ExtResource("2_ac7ve")
autoplay = true

[node name="RhythmGameHolder" type="Control" parent="."]
layout_mode = 3
anchors_preset = 10
anchor_right = 1.0
grow_horizontal = 2

[node name="MissArea" type="Area2D" parent="RhythmGameHolder"]
position = Vector2(0, -79)

[node name="CollisionShape2D" type="CollisionShape2D" parent="RhythmGameHolder/MissArea"]
position = Vector2(572.5, 0)
shape = SubResource("RectangleShape2D_4fsn0")

[node name="PlayerSection" type="Control" parent="RhythmGameHolder"]
layout_mode = 1
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -1.0
offset_top = 94.0
offset_right = 39.0
offset_bottom = 134.0
grow_horizontal = 2

[node name="PlayerNote" type="Node2D" parent="RhythmGameHolder/PlayerSection"]
position = Vector2(-150, 0)
script = ExtResource("2_e3i65")
inputKey = "rhythmgame_left"

[node name="Note" type="Area2D" parent="RhythmGameHolder/PlayerSection/PlayerNote"]

[node name="Sprite2D" type="Sprite2D" parent="RhythmGameHolder/PlayerSection/PlayerNote/Note"]
scale = Vector2(0.9, 0.9)
texture = ExtResource("4_l17yx")

[node name="CollisionShape2D" type="CollisionShape2D" parent="RhythmGameHolder/PlayerSection/PlayerNote/Note"]
shape = SubResource("CircleShape2D_vs5r6")

[node name="PlayerNote2" type="Node2D" parent="RhythmGameHolder/PlayerSection"]
position = Vector2(-50, 0)
script = ExtResource("2_e3i65")
inputKey = "rhythmgame_down"

[node name="Note" type="Area2D" parent="RhythmGameHolder/PlayerSection/PlayerNote2"]

[node name="Sprite2D" type="Sprite2D" parent="RhythmGameHolder/PlayerSection/PlayerNote2/Note"]
scale = Vector2(0.9, 0.9)
texture = ExtResource("5_52atg")

[node name="CollisionShape2D" type="CollisionShape2D" parent="RhythmGameHolder/PlayerSection/PlayerNote2/Note"]
shape = SubResource("CircleShape2D_vs5r6")

[node name="PlayerNote3" type="Node2D" parent="RhythmGameHolder/PlayerSection"]
position = Vector2(50, 0)
script = ExtResource("2_e3i65")
inputKey = "rhythmgame_up"

[node name="Note" type="Area2D" parent="RhythmGameHolder/PlayerSection/PlayerNote3"]

[node name="Sprite2D" type="Sprite2D" parent="RhythmGameHolder/PlayerSection/PlayerNote3/Note"]
scale = Vector2(0.9, 0.9)
texture = ExtResource("6_p126d")

[node name="CollisionShape2D" type="CollisionShape2D" parent="RhythmGameHolder/PlayerSection/PlayerNote3/Note"]
shape = SubResource("CircleShape2D_vs5r6")

[node name="PlayerNote4" type="Node2D" parent="RhythmGameHolder/PlayerSection"]
position = Vector2(150, 0)
script = ExtResource("2_e3i65")
inputKey = "rhythmgame_right"

[node name="Note" type="Area2D" parent="RhythmGameHolder/PlayerSection/PlayerNote4"]

[node name="Sprite2D" type="Sprite2D" parent="RhythmGameHolder/PlayerSection/PlayerNote4/Note"]
scale = Vector2(0.9, 0.9)
texture = ExtResource("7_c7hc3")

[node name="CollisionShape2D" type="CollisionShape2D" parent="RhythmGameHolder/PlayerSection/PlayerNote4/Note"]
shape = SubResource("CircleShape2D_vs5r6")

[node name="Conductor" type="Control" parent="RhythmGameHolder"]
layout_mode = 1
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -1.0
offset_top = 150.0
offset_right = 39.0
offset_bottom = 190.0
grow_horizontal = 2
script = ExtResource("7_u1p3x")
speed = 630.253

[node name="HittableNote" type="Node2D" parent="RhythmGameHolder/Conductor"]
position = Vector2(-150, 550)

[node name="HittableNote" type="Area2D" parent="RhythmGameHolder/Conductor/HittableNote"]
metadata/hittable = false

[node name="Sprite2D" type="Sprite2D" parent="RhythmGameHolder/Conductor/HittableNote/HittableNote"]
scale = Vector2(0.8, 0.8)
texture = ExtResource("4_l17yx")

[node name="CollisionShape2D" type="CollisionShape2D" parent="RhythmGameHolder/Conductor/HittableNote/HittableNote"]
shape = SubResource("CircleShape2D_vs5r6")

[node name="HittableNote2" type="Node2D" parent="RhythmGameHolder/Conductor"]
position = Vector2(-50, 750)

[node name="HittableNote" type="Area2D" parent="RhythmGameHolder/Conductor/HittableNote2"]
metadata/hittable = false

[node name="Sprite2D" type="Sprite2D" parent="RhythmGameHolder/Conductor/HittableNote2/HittableNote"]
scale = Vector2(0.8, 0.8)
texture = ExtResource("5_52atg")

[node name="CollisionShape2D" type="CollisionShape2D" parent="RhythmGameHolder/Conductor/HittableNote2/HittableNote"]
shape = SubResource("CircleShape2D_vs5r6")

[node name="HittableNote3" type="Node2D" parent="RhythmGameHolder/Conductor"]
position = Vector2(50, 950)

[node name="HittableNote" type="Area2D" parent="RhythmGameHolder/Conductor/HittableNote3"]
metadata/hittable = false

[node name="Sprite2D" type="Sprite2D" parent="RhythmGameHolder/Conductor/HittableNote3/HittableNote"]
scale = Vector2(0.8, 0.8)
texture = ExtResource("6_p126d")

[node name="CollisionShape2D" type="CollisionShape2D" parent="RhythmGameHolder/Conductor/HittableNote3/HittableNote"]
shape = SubResource("CircleShape2D_vs5r6")

[node name="HittableNote4" type="Node2D" parent="RhythmGameHolder/Conductor"]
position = Vector2(150, 1150)

[node name="HittableNote" type="Area2D" parent="RhythmGameHolder/Conductor/HittableNote4"]
metadata/hittable = false

[node name="Sprite2D" type="Sprite2D" parent="RhythmGameHolder/Conductor/HittableNote4/HittableNote"]
scale = Vector2(0.8, 0.8)
texture = ExtResource("7_c7hc3")

[node name="CollisionShape2D" type="CollisionShape2D" parent="RhythmGameHolder/Conductor/HittableNote4/HittableNote"]
shape = SubResource("CircleShape2D_vs5r6")

[node name="UIHolder" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="ScoreLabel" type="Label" parent="UIHolder"]
offset_left = 24.0
offset_top = 71.57
offset_right = 141.0
offset_bottom = 118.57
rotation = -0.268526
theme_override_fonts/font = ExtResource("9_ii8yx")
theme_override_font_sizes/font_size = 18
text = "Score: 0"

[node name="FpsLabel" type="Label" parent="UIHolder"]
offset_left = 35.0
offset_top = 107.0
offset_right = 152.0
offset_bottom = 154.0
rotation = -0.268526
theme_override_fonts/font = ExtResource("9_ii8yx")
theme_override_font_sizes/font_size = 12
text = "FPS: 0"
script = ExtResource("9_5aavs")

[connection signal="PlayerLoss" from="." to="." method="on_player_loss"]
[connection signal="area_entered" from="RhythmGameHolder/MissArea" to="RhythmGameHolder/PlayerSection/PlayerNote" method="scrolling_note_miss"]
[connection signal="playerHitNote" from="RhythmGameHolder/PlayerSection/PlayerNote" to="." method="hit_note"]
[connection signal="playerMissNote" from="RhythmGameHolder/PlayerSection/PlayerNote" to="." method="miss_note"]
[connection signal="playerHitNote" from="RhythmGameHolder/PlayerSection/PlayerNote2" to="." method="hit_note"]
[connection signal="playerMissNote" from="RhythmGameHolder/PlayerSection/PlayerNote2" to="." method="miss_note"]
[connection signal="playerHitNote" from="RhythmGameHolder/PlayerSection/PlayerNote3" to="." method="hit_note"]
[connection signal="playerMissNote" from="RhythmGameHolder/PlayerSection/PlayerNote3" to="." method="miss_note"]
[connection signal="playerHitNote" from="RhythmGameHolder/PlayerSection/PlayerNote4" to="." method="hit_note"]
[connection signal="playerMissNote" from="RhythmGameHolder/PlayerSection/PlayerNote4" to="." method="miss_note"]
